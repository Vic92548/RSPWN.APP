<template data-vapr="library-game-item">
    <div class="game-item" id="game-item-{{game-id}}">
        {{#is-installed}}
        <div class="game-status-badge installed">
            <i class="fa-solid fa-check-circle"></i> Installed{{#installed-version}} (v{{installed-version}}){{/installed-version}}
        </div>
        {{/is-installed}}
        {{#is-downloading}}<div class="game-status-badge downloading"><i class="fa-solid fa-download"></i> Downloading</div>{{/is-downloading}}
        {{#has-update}}<div class="game-status-badge update-available"><i class="fa-solid fa-arrow-up"></i> Update Available</div>{{/has-update}}
        <div class="game-cover-wrapper">
            <img src="{{cover-image}}" class="game-cover" alt="{{title}}">
        </div>
        <div class="game-content">
            <h4 class="game-title">{{title}}</h4>
            <p class="game-description">{{description}}</p>
            <div class="game-meta">
                <div class="game-meta-item">
                    <i class="fa-solid fa-calendar"></i>
                    <span>Owned <span class="owned-date"></span></span>
                </div>
                <div class="game-meta-item">
                    <i class="fa-solid fa-clock"></i>
                    <span>Total Playtime {{total-playtime}}</span>
                </div>
                {{#installed-version}}
                <div class="game-meta-item">
                    <i class="fa-solid fa-code-branch"></i>
                    <span>v{{installed-version}}</span>
                </div>
                {{/installed-version}}
            </div>
            {{#download-url}}
            {{^is-downloading}}
            {{#is-installed}}
            {{#has-update}}
            <div class="game-actions">
                <button class="game-action-button primary" onclick="window.downloadUpdate('{{game-id}}', '{{latest-version}}', '{{download-url}}')">
                    <i class="fa-solid fa-arrow-up"></i> Update to v{{latest-version}}
                </button>
            </div>
            {{/has-update}}
            {{^has-update}}
            {{#executable}}
            <div class="game-actions">
                <button class="game-action-button play" onclick="window.launchGame(event, '{{executable}}')">
                    <i class="fa-solid fa-play"></i> Play
                </button>
                <button class="game-action-button icon-only danger" onclick="window.uninstallGame(event, '{{game-id}}', '{{title}}')">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>
            {{/executable}}
            {{/has-update}}
            {{/is-installed}}
            {{^is-installed}}
            <div class="game-actions">
                <button class="game-action-button primary" onclick="window.downloadGame(event, '{{game-id}}', '{{title}}', '{{download-url}}')">
                    <i class="fa-solid fa-download"></i> <span class="download-button-text">Download</span>
                </button>
            </div>
            {{/is-installed}}
            {{/is-downloading}}
            {{/download-url}}
        </div>
        {{#is-downloading}}
        <div class="download-progress-overlay">
            <div class="download-progress-container">
                <div class="download-progress-header">
                    <div class="download-progress-icon">
                        <i class="fa-solid fa-download"></i>
                    </div>
                    <div class="download-progress-title">{{#is-updating}}Updating{{/is-updating}}{{^is-updating}}Downloading{{/is-updating}} Game</div>
                    <div class="download-progress-subtitle">{{title}}</div>
                </div>
                <div class="download-progress-stats">
                    <div class="download-stat">
                        <span class="download-stat-value" id="download-progress-{{game-id}}">{{download-progress}}%</span>
                        <span class="download-stat-label">Progress</span>
                    </div>
                    <div class="download-stat">
                        <span class="download-stat-value" id="download-speed-{{game-id}}">0 MB/s</span>
                        <span class="download-stat-label">Speed</span>
                    </div>
                </div>
                <div class="download-progress-bar-wrapper">
                    <div class="download-progress-bar">
                        <div class="download-progress-fill" id="download-fill-{{game-id}}" style="width: {{download-progress}}%"></div>
                    </div>
                    <div class="download-info">
                        <span><i class="fa-solid fa-database"></i> <span id="download-size-{{game-id}}">0 MB / 0 MB</span></span>
                        <span><i class="fa-solid fa-clock"></i> <span id="download-eta-{{game-id}}">Calculating...</span></span>
                    </div>
                </div>
                <button class="cancel-download-btn" onclick="window.cancelDownload('{{game-id}}')">
                    <i class="fa-solid fa-xmark"></i> Cancel {{#is-updating}}Update{{/is-updating}}{{^is-updating}}Download{{/is-updating}}
                </button>
            </div>
        </div>
        {{/is-downloading}}
    </div>
</template>